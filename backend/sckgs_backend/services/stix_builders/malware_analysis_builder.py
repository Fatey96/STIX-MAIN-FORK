from .stix_builder import StixBuilder
from stix2 import MalwareAnalysis
import faker
import json

class MalwareAnalysisBuilder(StixBuilder):
    def __init__(self, data):
        self.product = data.get('product')
        self.version = data.get('version')
        self.host_vm_ref = data.get('host_vm_ref')
        self.operating_system_ref = data.get('operating_system_re')
        self.installed_software_refs = data.get('installed_software_refs')
        self.configuration_version = data.get('configuration_version')
        self.modules = data.get('modules')
        self.analysis_engine_version = data.get('analysis_engine_version')
        self.analysis_definition_version = data.get('analysis_definition_version')
        self.submitted = data.get('submitted')
        self.analysis_started = data.get('analysis_started')
        self.analysis_ended = data.get('analysis_ended')
        self.result_name = data.get('result_name')
        self.result = data.get('result')
        self.analysis_sco_refs = data.get('analysis_sco_refs')
        self.sample_ref = data.get('sample_ref')

    def create(self):
        return MalwareAnalysis(product=self.product)
            